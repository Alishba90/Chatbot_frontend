{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, ElementRef, ViewChild } from '@angular/core';\nimport { tap } from 'rxjs/operators';\nexport let AppComponent = class AppComponent {\n  ngAfterViewInit() {\n    this.setScrollbarVisibility();\n  }\n  constructor(http, renderer, elRef) {\n    this.http = http;\n    this.renderer = renderer;\n    this.elRef = elRef;\n    this.showInitialMsg = true;\n    this.djangoUrl = 'http://127.0.0.1:8000'; // Replace with your Django backend URL\n    this.testingdjangoUrl = 'http://127.0.0.1:8000/appname/chat/'; // Replace with your Django backend URL\n    this.chatData = [{\n      query: \"\",\n      response: \"\",\n      time: \"\"\n    }\n    // Add more objects as needed\n    ];\n\n    this.inputValue = '';\n    this.myScrollContainer = new ElementRef(null);\n  }\n  ngAfterViewChecked() {\n    this.scrollToBottom();\n  }\n  scrollToBottom() {\n    try {\n      this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight;\n    } catch (err) {}\n  }\n  sendQuery() {\n    if (this.inputValue.trim() !== '') {\n      if (this.showInitialMsg) {\n        this.showInitialMsg = false;\n      }\n      const date = new Date(); // Replace this line with your date string\n      const ampm = date.getHours() >= 12 ? 'PM' : 'AM';\n      let query = this.inputValue;\n      const formattedTime = date.getHours() + ':' + date.getMinutes() + ' ' + ampm;\n      this.chatData.push({\n        query: this.inputValue,\n        response: '',\n        time: formattedTime\n      });\n      this.http.post(this.testingdjangoUrl, {\n        query: this.inputValue\n      }).pipe(tap(response => {\n        // Handle the response from the backend here\n        const index = this.chatData.findIndex(item => item.query === query);\n        this.scrollToBottom();\n        if (index !== -1) {\n          this.chatData[index].response = this.formatResponse(response.response);\n          query = '';\n        }\n        console.log('Response from backend:', response);\n      }, error => {\n        console.error('Error in sending the query to the backend', error);\n      })).subscribe();\n      this.inputValue = ''; // Clear the input value after sending the query\n    }\n  }\n\n  formatResponse(response) {\n    const stepsRegex = /\\d+\\.\\s/g;\n    const stepsReplaced = response.replace(stepsRegex, match => {\n      return '\\n' + match;\n    });\n    return stepsReplaced;\n  }\n  setScrollbarVisibility() {\n    const targetDiv = this.elRef.nativeElement.querySelector('#chatContainer'); // Replace 'your-div-id' with your div's ID\n    if (this.showInitialMsg) {\n      this.renderer.setStyle(targetDiv, 'overflow', 'hidden');\n    } else {\n      this.renderer.removeStyle(targetDiv, 'overflow');\n      this.renderer.setStyle(targetDiv, 'overflow-y', 'scroll');\n    }\n  }\n  refreshQuery() {\n    if (this.chatData.length > 0) {\n      const lastQuery = this.chatData[this.chatData.length - 1].query;\n      this.chatData[this.chatData.length - 1].response = '';\n      this.http.post(this.testingdjangoUrl, {\n        query: lastQuery\n      }).pipe(tap(response => {\n        // Handle the response from the backend here\n        const index = this.chatData.findIndex(item => item.query === lastQuery);\n        if (index !== -1) {\n          this.chatData[index].response = response.response;\n        }\n        console.log('Response from backend:', response);\n      }, error => {\n        console.error('Error in sending the query to the backend', error);\n      })).subscribe();\n    } else {\n      console.log('No queries available to refresh');\n    }\n  }\n};\n__decorate([ViewChild('scrollDiv', {\n  static: true\n})], AppComponent.prototype, \"myScrollContainer\", void 0);\nAppComponent = __decorate([Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})], AppComponent);","map":{"version":3,"names":["Component","ElementRef","ViewChild","tap","AppComponent","ngAfterViewInit","setScrollbarVisibility","constructor","http","renderer","elRef","showInitialMsg","djangoUrl","testingdjangoUrl","chatData","query","response","time","inputValue","myScrollContainer","ngAfterViewChecked","scrollToBottom","nativeElement","scrollTop","scrollHeight","err","sendQuery","trim","date","Date","ampm","getHours","formattedTime","getMinutes","push","post","pipe","index","findIndex","item","formatResponse","console","log","error","subscribe","stepsRegex","stepsReplaced","replace","match","targetDiv","querySelector","setStyle","removeStyle","refreshQuery","length","lastQuery","__decorate","static","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\alishba.arshad\\Desktop\\Alishba\\Chatbot\\Project\\chatbot-frontend\\src\\app\\app.component.ts"],"sourcesContent":["import { Component  ,Renderer2,ElementRef,ViewChild, AfterViewChecked} from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { tap } from 'rxjs/operators';\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\n\n\nexport class AppComponent implements AfterViewChecked {\n  showInitialMsg: boolean = true;\n  @ViewChild('scrollDiv', { static: true }) private myScrollContainer: ElementRef;\n  private djangoUrl = 'http://127.0.0.1:8000'; // Replace with your Django backend URL\n  private testingdjangoUrl = 'http://127.0.0.1:8000/appname/chat/'; // Replace with your Django backend URL\n  chatData = [\n    { query: \"\", response: \"\", time: \"\" },\n    \n    // Add more objects as needed\n  ];\n\n  ngAfterViewInit() {\n    this.setScrollbarVisibility();\n  }\n  constructor(private http: HttpClient,private renderer: Renderer2,private elRef: ElementRef) {\n    this.myScrollContainer = new ElementRef(null);\n  }\n\n  \n\n  inputValue: string = '';\n\n\n  ngAfterViewChecked() {\n    this.scrollToBottom();\n  }\n\n  scrollToBottom(): void {\n    try {\n      this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight;\n    } catch(err) { }\n  }\n\n\n  sendQuery() {\n    if (this.inputValue.trim() !== '') {\n      if(this.showInitialMsg){\n        this.showInitialMsg=false\n      }\n      const date = new Date(); // Replace this line with your date string\n      const ampm = date.getHours() >= 12 ? 'PM' : 'AM';\n      let query = this.inputValue;\n      const formattedTime = date.getHours() + ':' + date.getMinutes() + ' ' + ampm;\n      this.chatData.push({ query: this.inputValue, response: '', time: formattedTime });\n  \n      this.http.post(this.testingdjangoUrl, { query: this.inputValue }).pipe(\n        tap(\n          (response: any) => {\n            // Handle the response from the backend here\n            const index = this.chatData.findIndex(item => item.query === query);\n            this.scrollToBottom();\n            if (index !== -1) {\n              this.chatData[index].response = this.formatResponse(response.response);\n              query = '';\n            }\n            console.log('Response from backend:', response);\n          },\n          (error: any) => {\n            console.error('Error in sending the query to the backend', error);\n          }\n        )\n      ).subscribe();\n      this.inputValue = ''; // Clear the input value after sending the query\n    }\n  }\n  formatResponse(response: string): string {\n    const stepsRegex = /\\d+\\.\\s/g;\n    const stepsReplaced = response.replace(stepsRegex, (match) => {\n      return '\\n' + match;\n    });\n    return stepsReplaced;\n  }\n  setScrollbarVisibility() {\n\n    const targetDiv = this.elRef.nativeElement.querySelector('#chatContainer'); // Replace 'your-div-id' with your div's ID\n    if (this.showInitialMsg) {\n      this.renderer.setStyle(targetDiv, 'overflow', 'hidden');\n    } else {\n      this.renderer.removeStyle(targetDiv, 'overflow');\n      this.renderer.setStyle(targetDiv, 'overflow-y', 'scroll');\n    }\n  }\n  \n  refreshQuery() {\n    if (this.chatData.length > 0) {\n      const lastQuery = this.chatData[this.chatData.length - 1].query;\n      this.chatData[this.chatData.length - 1].response='';\n      this.http.post(this.testingdjangoUrl, { query: lastQuery }).pipe(\n        tap(\n          (response: any) => {\n            // Handle the response from the backend here\n            const index = this.chatData.findIndex(item => item.query ===lastQuery );\n            if (index !== -1) {\n              this.chatData[index].response = response.response;\n              \n            }\n            console.log('Response from backend:', response);\n          },\n          (error: any) => {\n            console.error('Error in sending the query to the backend', error);\n          }\n        )\n      ).subscribe();\n    } else {\n      console.log('No queries available to refresh');\n    }\n  }\n\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}